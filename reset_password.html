<!DOCTYPE html>
<meta charset="UTF-8">
<script src="https://cdn.jsdelivr.net/npm/skapi-js@beta/dist/skapi.js"></script>
<script src="service.js"></script>

<h1>Reset Password</h1>

<p id="help">
    Enter the verification code sent to ${email}
    <br>
    Enter the new password and click Reset Password.
</p>

<form action="index.html" onsubmit="skapi.resetPassword(event).then(res => {
    window.alert('New password has been set');
})">
    <input type="email" name="email" hidden>

    <label>
        6 Letter Verification Code<br>
        <input type="text" name="code" placeholder="######" required>
    </label>

    <br>
    <br>
    <label>
        New Password<br>
        <input type="password" name="new_password" placeholder="At least 6 char" required>
    </label>
    <br>
    <br>
    <input type="submit" value="Reset Password">
</form>

<script>
    let urlParams = new URLSearchParams(window.location.search);
    let email = urlParams.get('email');
    email = decodeURIComponent(email);
    document.querySelector('[name=email]').value = email;
    help.innerHTML = help.innerHTML.replace('${email}', email);
</script>